{% extends 'base.html' %}

{% block content %}
<style>
/* ---------- Trading Ticker ---------- */
.trading-ticker {
    background: #111;
    color: #0f0;
    font-weight: bold;
    overflow: hidden;
    white-space: nowrap;
    border-bottom: 2px solid #444;
}
.ticker-wrap {
    display: flex;
    animation: ticker 30s linear infinite;
}
.ticker span {
    padding: 0 3rem;
}
@keyframes ticker {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
}

/* ---------- Dashboard Layout ---------- */
.dashboard-container {
    max-width: 1200px;
    margin: auto;
}

/* Summary Cards */
.stat-card {
    background: linear-gradient(135deg, #2d3748, #1a202c);
    color: #fff;
    padding: 1.5rem;
    border-radius: 1rem;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    transition: transform 0.2s, box-shadow 0.2s;
}
.stat-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.4);
}
.stat-card h5 {
    font-size: 1.1rem;
    margin-bottom: 0.8rem;
    letter-spacing: 1px;
    color: #cbd5e0;
}
.stat-value {
    font-weight: bold;
    font-size: clamp(1rem, 3vw, 2rem);
    overflow-wrap: break-word;
    color: #f6e05e;
}

/* Balance card gradient */
.balance-card {
    background: linear-gradient(135deg, #3182ce, #2b6cb0);
}
/* Invested card gradient */
.invested-card {
    background: linear-gradient(135deg, #38a169, #2f855a);
}
/* Net worth card gradient */
.networth-card {
    background: linear-gradient(135deg, #d69e2e, #b7791f);
}

/* ---------- Transactions Table ---------- */
.section-title {
    margin-top: 2rem;
    font-weight: 600;
    color: #2d3748;
}

.transaction-table {
    border-radius: 0.75rem;
    /* overflow: hidden; */
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}
.transaction-table th {
    font-size: 0.95rem;
    letter-spacing: 0.5px;
}
.transaction-table td {
    vertical-align: middle;
    font-size: 0.9rem;
}
.buy-type {
    color: #38a169;
    font-weight: bold;
}
.sell-type {
    color: #e53e3e;
    font-weight: bold;
}

div[style*="overflow-y: auto;"]::-webkit-scrollbar {
    width: 8px;
}

div[style*="overflow-y: auto;"]::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

div[style*="overflow-y: auto;"]::-webkit-scrollbar-thumb:hover {
    background: #555;
}

</style>

<!-- Trading Ticker -->
<div class="trading-ticker">
    <div class="ticker-wrap">
        <div class="ticker">
            <span>BTC/USD: $29,400 â–² 1.25%</span>
            <span>ETH/USD: $1,850 â–² 0.85%</span>
            <span>TSLA: $730 â–¼ 0.40%</span>
            <span>GOOGL: $2,820 â–² 0.60%</span>
            <span>AMZN: $3,450 â–² 1.10%</span>
            <span>EUR/USD: 1.0950 â–¼ 0.12%</span>
        </div>
    </div>
</div>

<div class="container mt-4 dashboard-container">
    <h2 class="welcome-text">Welcome, {{ current_user.name }} ðŸ‘‹</h2>
    
    <!-- Summary Cards -->
    <div class="row mt-4 g-4">
        <div class="col-md-4 col-sm-12">
            <div class="stat-card balance-card">
                <h5>Balance</h5>
                <p class="stat-value">${{ current_user.balance | round(2) }}</p>
            </div>
        </div>
        <div class="col-md-4 col-sm-12">
            <div class="stat-card invested-card">
                <h5>Invested</h5>
                <p class="stat-value">${{ total_invested | round(2) }}</p>
            </div>
        </div>
        <div class="col-md-4 col-sm-12">
            <div class="stat-card networth-card">
                <h5>Net Worth</h5>
                <p class="stat-value">${{ net_worth | round(2) }}</p>
            </div>
        </div>
    </div>

    <!-- Transactions -->
    <h4 class="mt-5 section-title">ðŸ“œ Recent Transactions</h4>
    <div class="table-responsive">
        <div style="max-height: 300px; overflow-y: auto;">
        <table class="table table-hover table-striped transaction-table">
            <thead class="table-dark">
                <tr>
                    <th>Date</th>
                    <th>Asset</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Type</th>
                </tr>
            </thead>
            <tbody>
                {% for t in transaction %}
                <tr>
                    <td>{{ t.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>{{ t.symbol }}</td>
                    <td>{{ t.quantity }}</td>
                    <td>${{ t.price }}</td>
                    <td class="{% if t.transaction_type == 'BUY' %}buy-type{% else %}sell-type{% endif %}">
                        {{ t.transaction_type }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
    </div>
</div>
{% endblock %}
